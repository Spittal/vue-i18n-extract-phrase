{"version":3,"file":"vue-i18n-phrase.modern.js","sources":["../src/phrase/projects.ts","../src/phrase/locales.ts","../src/phrase/files.ts","../src/phrase/setup.ts","../src/commands/sync.ts","../src/index.ts"],"sourcesContent":["import axios from 'axios';\nimport { PhraseProject } from '../types';\n\nexport async function getProject (projectID?: string): Promise<PhraseProject> {\n  const { data: projects }: { data: PhraseProject[] } =\n    await axios.get('https://api.phraseapp.com/api/v2/projects');\n\n  const project = (projectID) ? projects.find((project) => project.id === projectID) : projects[0];\n\n  if (!project) throw new Error('Could not find project from PhraseAPI. If no project was defined as an argument, then there is no project in the selected Phrase Account')\n\n  return project;\n}\n","import axios from 'axios';\nimport { PhraseProject, PhraseLocale } from '../types';\n\nfunction getLastPageFromLink (link: string): number {\n  const regex = /page=([0-9]*)&per_page=100>; rel=last/;\n  const regexMatch = regex.exec(link);\n\n  if (!regexMatch) throw new Error('Could not get pagination info from the PhraseAPI');\n\n  return parseInt(regexMatch[1]);\n}\n\nasync function getPageOfLocales (project: PhraseProject, page: number): Promise<{ data: PhraseLocale[]; lastPage: number }> {\n  const { data, headers } = await axios.get(`https://api.phraseapp.com/api/v2/projects/${project.id}/locales`, {\n    params: {\n      page,\n      per_page: 100, // eslint-disable-line @typescript-eslint/camelcase\n    },\n  });\n  return {\n    data,\n    lastPage: getLastPageFromLink(headers.link),\n  };\n}\n\nexport async function getLocales (project: PhraseProject): Promise<PhraseLocale[]> {\n  const locales: PhraseLocale[] = [];\n\n  const { data: firstData, lastPage } = await getPageOfLocales(project, 1);\n  locales.push(...firstData);\n\n  for (let page = 2; page <= lastPage; page++) {\n    const { data } = await getPageOfLocales(project, page);\n    locales.push(...data);\n  }\n\n  return locales;\n}\n\nexport async function getLocale (project: PhraseProject, localeCode: string | boolean = false, locales?: PhraseLocale[]): Promise<PhraseLocale> {\n  if (!locales) {\n    locales = await getLocales(project);\n  }\n\n  let locale: PhraseLocale | undefined;\n  if (typeof localeCode === 'string') {\n    locale = locales.find((locale) => locale.code === localeCode);\n  } else {\n    locale = locales.find((locale) => locale.default);\n  }\n\n  if (!locale) throw new Error('Locale not found, is the argument makeTranslation set correctly?');\n\n  return locale;\n}\n\n\n","import axios from 'axios';\nimport {\n  PhraseLocale,\n  PhraseProject,\n  PhraseTranslation,\n  PhraseUpload,\n} from '../types';\nimport {\n  I18NLanguage,\n  I18NItem,\n} from 'vue-i18n-extract/dist-types/library/models';\nimport FormData from 'form-data';\nimport fs from 'fs';\n\nexport async function confirmUploadSuccess (\n  project: PhraseProject,\n  upload: PhraseUpload,\n): Promise<PhraseUpload> {\n  return new Promise((resolve, reject) => {\n    let count = 1;\n    function viewUploadDetails (): void {\n      if (count < 13) {\n        setTimeout(async () => {\n          const { data: uploadedFile }: { data: PhraseUpload } =\n          await axios.get(`https://api.phraseapp.com/api/v2/projects/${project.id}/uploads/${upload.id}`);\n          if (uploadedFile.state === 'success') {\n            resolve(uploadedFile);\n          } else {\n            count++;\n            viewUploadDetails();\n          }\n        }, 500);\n      } else {\n        reject(\n          'It has taken over a minute to confirm the upload was a success. ' +\n          'Please refer to your Phrase Dashboard Web UI Uploaded Files section for more information.',\n        );\n      }\n    }\n    viewUploadDetails();\n  });\n}\n\nexport async function uploadLanguageFile (\n  filePath: string,\n  project: PhraseProject,\n  locale: PhraseLocale,\n  tags?: string,\n  makeTranslation: boolean | string = false,\n): Promise<PhraseUpload> {\n  const formData = new FormData();\n\n  formData.append(\n    'file',\n    fs.createReadStream(filePath),\n    `${locale.code}-${(tags || '').split(',').join('-')}.json`,\n  );\n  formData.append('file_format', `simple_json`);\n  formData.append('locale_id', locale.id);\n  if (tags) {\n    formData.append('tags', tags);\n  }\n  formData.append('update_translations', `${!!makeTranslation}`);\n  formData.append('skip_upload_tags', 'true');\n\n  const { data: uploadedFile }: { data: PhraseUpload } = await axios.post(\n    `https://api.phraseapp.com/api/v2/projects/${project.id}/uploads`,\n    formData,\n    {\n      headers: formData.getHeaders(),\n    },\n  );\n\n  return confirmUploadSuccess(project, uploadedFile);\n}\n\n\n\nexport async function downloadAllTranslationsToI18NLanguage (\n  locales: PhraseLocale[],\n  project: PhraseProject,\n  tags?: string,\n): Promise<I18NLanguage> {\n  const i18nLanguage: I18NLanguage = {};\n\n  for (const locale of locales) {\n    const { data }: { data: PhraseTranslation[] } = await axios.get(\n      `https://api.phraseapp.com/api/v2/projects/${project.id}/locales/${\n        locale.id\n      }/download`,\n      { params: { file_format: 'simple_json', tags } }, // eslint-disable-line @typescript-eslint/camelcase\n    );\n\n    i18nLanguage[locale.code] = Object.keys(data).map((path) => {\n      return {\n        language: locale.code,\n        path,\n      };\n    }) as I18NItem[];\n  }\n\n  return i18nLanguage;\n}\n","import axios, { AxiosError } from 'axios';\n\nexport function setupAxios (accessToken: string): void {\n  axios.defaults.headers.common.Authorization = `token ${accessToken}`;\n  axios.interceptors.response.use(\n    (response) => response,\n    (error: AxiosError) => {\n      if (error.response && error.response.status === 429) {\n        throw new Error('Too many requests sent to the PhraseAPI, please wait 5 minutes and try again.');\n      }\n\n      throw error;\n    },\n  );\n}\n","import chalk from 'chalk';\nimport fs from 'fs';\nimport path from 'path';\nimport VueI18NExtract from 'vue-i18n-extract';\nimport { I18NItem } from 'vue-i18n-extract/dist-types/library/models';\nimport {\n  getLocale,\n  getProject,\n  setupAxios,\n  uploadLanguageFile,\n  downloadAllTranslationsToI18NLanguage,\n  getLocales,\n} from '../phrase';\nimport {\n  SyncCommandOptions,\n  PhraseLocale,\n} from '../types';\n\nfunction parsedVueFilesToJSON (\n  parsedVueFiles: I18NItem[],\n  makeTranslation: boolean | string = false,\n): Record<string, string> {\n  return parsedVueFiles.reduce((accumulator, i18nItem) => {\n    if (!!makeTranslation) {\n      accumulator[i18nItem.path] = i18nItem.path;\n    } else {\n      accumulator[i18nItem.path] = '';\n    }\n    return accumulator;\n  }, {});\n}\n\nasync function makeOutputDir (outputDir: string): Promise<void> {\n  return fs.mkdir(\n    path.resolve(process.cwd(), outputDir),\n    { recursive: true },\n    (err) => { if (err) { throw err; } },\n  );\n}\n\nfunction writeLanguageJSON (languageJSON: object, outputDir: string, locale: PhraseLocale): string {\n  const filePath = path.resolve(process.cwd(), outputDir, `${locale.code}.json`);\n  fs.writeFile(\n    filePath,\n    JSON.stringify(languageJSON),\n    (err) => { if (err) { throw err; } },\n  );\n  return filePath;\n}\n\nexport async function sync ({\n  vueFiles,\n  accessToken,\n  projectID,\n  tags,\n  makeTranslation,\n  skipReport = false,\n  dryRun = false,\n  outputDir = './phrase-reports',\n}: SyncCommandOptions): Promise<void> {\n  const parsedVueFiles = VueI18NExtract.parseVueFiles(vueFiles);\n  const languageJSON = parsedVueFilesToJSON(parsedVueFiles, makeTranslation);\n\n  console.log(chalk.green(`\\nFound ${Object.keys(languageJSON).length} unique keys in your Vue.js files`));\n\n  setupAxios(accessToken);\n\n  console.log(chalk.bold(`\\nGetting Phrase project and locale...`));\n\n  const selectedProject = await getProject(projectID);\n  const locales = await getLocales(selectedProject);\n  const selectedLocale = await getLocale(selectedProject, makeTranslation, locales);\n\n  console.log(`Using project: ${chalk.green(selectedProject.name)}`);\n  console.log(`Using locale: ${chalk.green(selectedLocale.code)}`);\n\n  await makeOutputDir(outputDir);\n  const filePath = writeLanguageJSON(languageJSON, outputDir, selectedLocale);\n\n  console.log(`\\nUploading keys to Phrase for the ${chalk.bold(selectedLocale.name)} locale.`);\n  if (tags) { console.log(`With the tags ${chalk.bold(tags)}`); }\n  if (!!makeTranslation) { console.log(`With the keys set as the translation`); }\n\n  if (!dryRun) {\n    const uploadedFile =\n      await uploadLanguageFile(filePath, selectedProject, selectedLocale, tags, makeTranslation);\n    console.log(`\\nKeys successfully added!`);\n    console.log(`\\nUpload File Summary:`);\n    console.log(`File Name: ${uploadedFile.filename}`);\n    console.log(`Keys Created: ${uploadedFile.summary.translation_keys_created}`);\n    console.log(`Keys Updated: ${uploadedFile.summary.translations_updated}`);\n    console.log(`Keys Unmentioned: ${uploadedFile.summary.translation_keys_unmentioned}`);\n    console.log(`Key Translations Created: ${uploadedFile.summary.translations_created}`);\n    console.log(`Key Translations Updated: ${uploadedFile.summary.translations_updated}`);\n    console.log(`Tags Created: ${uploadedFile.summary.tags_created}`);\n  } else {\n    console.log(chalk.bgRed.whiteBright(`\\nPsyke! it's a dry run, nothing is changed in Phrase!`));\n  }\n\n  if (!skipReport) {\n    console.log(chalk.bold(`\\nGenerating a full report...`));\n    if (tags) { console.log(`Getting all translations with the tags ${chalk.bold(tags)}`); }\n\n    const i18nLanguage = await downloadAllTranslationsToI18NLanguage(locales, selectedProject, tags);\n    const report = VueI18NExtract.extractI18NReport(parsedVueFiles, i18nLanguage);\n    await VueI18NExtract.writeReportToFile(report, `${outputDir}/report.json`);\n  }\n\n  console.log(chalk.green(`\\nComplete! you can view you language file and report at ${outputDir}\\n`));\n}\n","import { Command } from 'commander';\nimport { sync } from './commands/index.js';\n\nconst program = new Command();\nprogram\n  .version(process.env.npm_package_version || '0.0.0')\n  .usage('sync [options]')\n  .command('sync', { isDefault: true })\n  .option(\n    '-v --vueFiles <vueFiles>',\n    'A file glob pointing to your Vue.js source files.'\n  )\n  .option(\n    '-a --accessToken <accessToken>',\n    'Phrase API access token'\n  )\n  .option(\n    '-p --projectID [project]',\n    'Phrase Project ID, defaults to the first project in your account, projectID can be found on projects page, then hovering over project and choosing ID'\n  )\n  .option(\n    '-t, --tags [tags]',\n    'A comma separated list of any custom tags you would like to apply to the keys',\n  )\n  .option(\n    '-m --makeTranslation [makeTranslation]',\n    'If you would like the key path to be the translation in your default locale. Optionally set as a locale code to make translation in a non-default locale'\n  )\n  .option(\n    '-s --skipReport [skipReport]',\n    'Skip report generation'\n  )\n  .option(\n    '-o --outputDir [outputDir]',\n    'Directory for report files. Will default to ./phrase-reports',\n  )\n  .option(\n    '-d --dryRun [dryRun]',\n    'Use if you do not want anything posted to Phrase',\n  )\n  .action(sync);\n\nprogram.parse(process.argv);\n"],"names":["getProject","projectID","data","projects","axios","get","project","find","id","Error","getLastPageFromLink","link","regex","regexMatch","exec","parseInt","getPageOfLocales","page","headers","params","per_page","lastPage","getLocales","locales","firstData","push","getLocale","localeCode","locale","code","default","confirmUploadSuccess","upload","Promise","resolve","reject","count","viewUploadDetails","setTimeout","uploadedFile","state","uploadLanguageFile","filePath","tags","makeTranslation","formData","FormData","append","fs","createReadStream","split","join","post","getHeaders","downloadAllTranslationsToI18NLanguage","i18nLanguage","file_format","Object","keys","map","path","language","setupAxios","accessToken","defaults","common","Authorization","interceptors","response","use","error","status","parsedVueFilesToJSON","parsedVueFiles","reduce","accumulator","i18nItem","makeOutputDir","outputDir","mkdir","process","cwd","recursive","err","writeLanguageJSON","languageJSON","writeFile","JSON","stringify","sync","vueFiles","skipReport","dryRun","VueI18NExtract","parseVueFiles","console","log","chalk","green","length","bold","selectedProject","selectedLocale","name","filename","summary","translation_keys_created","translations_updated","translation_keys_unmentioned","translations_created","tags_created","bgRed","whiteBright","report","extractI18NReport","writeReportToFile","program","Command","version","env","npm_package_version","usage","command","isDefault","option","action","parse","argv"],"mappings":"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"}